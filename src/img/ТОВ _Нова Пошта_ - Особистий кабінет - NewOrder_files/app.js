var $configBox={_pages:{},linkPage:{pageForPay:"?r=loyaltyUser/paydocuments"},appParameters:{PreferredDeliveryDate:5},initApp:["$main","$helper"],initController:{loyaltyUser:["$payment"]},initControllerAction:{newOrder_index:["$neworder","$counterparties","$counterpartiesOnly","$paycard"],reports_index:["$reports"],additionalServices_index:["$additionalServices","$counterpartiesOnly","$orders"],additionalServices_editEWList:["$additionalServices","$orders"],additionalServices_redirectingReturnList:["$additionalServices","$orders"],additionalServices_termExtensionList:["$additionalServices","$orders"],additionalServices_editEW:["$additionalServices","$additionalServices_EditEW"],additionalServices_redirecting:["$additionalServices","$additionalServices_Redirecting","$counterparties","$counterpartiesOnly","$orders"],additionalServices_return:["$additionalServices","$additionalServices_Return","$counterparties","$counterpartiesOnly"],additionalServices_massiveReturn:["$additionalServices_MassiveReturn"],additionalServices_termExtension:["$additionalServices","$additionalServices_TermExtension"],reports_createNewReport:["$reports","$counterparties","$counterpartiesOnly"],archiveRequest_index:["$archiverequest"],settings_index:["$settings","$settingsAdditionalServices","$counterparties","$counterpartiesOnly","$paymentCards"],orders_index:["$counterpartiesOnly","$orders","$paycard"],orders_templates:["$counterpartiesOnly","$orders"],auth_forgotPassword:["$forgotPasswor"],auth_forgotCard:["$forgotPasswor"],loyaltyUser_index:["$loyalty","$paymentCards","$paycard"],scanSheet_index:["$scanSheets","$orders"],registration_index:["$registration"],registration_activation:["$registration"],auth_index:["$auth"],admin_getSendedEmails:["$admin_getSendedEmails"],admin_getCharts:["$admin_getCharts"],admin_benchmarkChart:["$admin_getCharts"],admin_getDocument:["$admin_getDocument"],admin_getLoyaltyInfo:["$admin_getLoyaltyInfo"],admin_getTranslations:["$admin_getTranslations"],admin_getTranslationsNP:["$admin_getTranslationsNP"],admin_getUser:["$admin_getUser"],admin_getUserEvents:["$admin_getUserEvents"],admin_predefinedValues:["$admin_predefinedValues"],admin_getMessageInformer:["$admin_getMessageInformer"],admin_getPollResult1:["$admin_getPollResult1"],admin_getPollResult2:["$admin_getPollResult1"],admin_getPolls:["$admin_getPolls"],admin_getMapsDataSets:["$admin_getMapsDataSets"],admin_stats:["$admin_stats"],admin_addVIPClient:["$admin_addVIPClient"],admin_permanenceApiKey:["$admin_permanenceApiKey"],admin_news:["$admin_news"],admin_permissionsManagement:["$admin_permissionsManagement"],admin_permissionsClientsManagement:["$admin_permissionsManagement"],admin_catalogsLocalization:["$admin_catalogsLocalization"],admin_changeRecipientAddress:["$admin_changeRecipientAddress"],admin_CCardRequests:["$cCardRequests"],admin_reviewTypes:["$admin_reviewTypes"],admin_pricingObjects:["$admin_pricingObjects"],admin_redBoxes:["$admin_redBoxes"],massiveUpload_integros:["$massiveUpload_integros","$counterparties"],massiveUpload_privatbank:["$massiveUpload_privatbank","$addresses"],massiveUpload_amway:["$massiveUpload_amway","$counterparties"],universalMassiveUpload_index:["$universalMassiveUpload_index","$counterparties"],massiveUpload_stat:["$massiveUpload_stat"],freight_save:["$freight"],freight_index:["$freightIndex"],site_cCardManagement:["$cCardManagement"],site_cCard:["$cCard"],redBox_save:["$redBoxes","$counterparties","$paycard"],redBox_index:["$redBoxes_index","$paycard"],redBoxMobile_save:["$redBoxesMobile","$paycard"],tariffPlans_success:["$tariffplans"],npiService_index:["loginController"],npiService_order:["loginController"],iewOrder_stepSender:["$iewOrder"],iewOrder_stepRecipient:["$iewOrder"],iewOrder_stepCargoInfo:["$iewOrder"],iewOrder_stepInvoice:["$iewOrder"],iewOrder_stepCheckOrder:["$iewOrder"],international_index:["$internationalOrders"]}};
$(function(){$init.initStart()});var $init=function(){var n={CurrentController:null,CurrentAction:null,CurrentControllerAction:null,storeInit:{},initApp:[],initController:{},initControllerAction:{},initStart:function(){$.ajaxSetup({url:Yii.app.createUrl("data/get",{container:"JSON"}),dataType:"json",type:"post",error:function(n,t){"abort"!=t&&"error"!=t&&noty(Yii.t("js","Возникла ошибка. Попробуйте позже"))}}),$(document).ajaxComplete(function(n,t){void 0!=t.responseJSON&&void 0!=t.responseJSON.success&&0==t.responseJSON.success&&"User is undefined"==t.responseJSON.errors[0]&&(alert("Ваша сессия работы в кабинете истекла. Пожалуйста, перезалогиньтесь."),window.location.reload)}),n.construct()},construct:function(){n.CurrentController=window.CurrentController,n.CurrentAction=window.CurrentAction,n.CurrentControllerAction=window.CurrentController+"_"+window.CurrentAction,n.appParameters=window.appParameters?window.appParameters:{},n.initApp=$configBox.initApp,n.initController=$configBox.initController,n.initControllerAction=$configBox.initControllerAction,n.init()},init:function(){for(var t in n.appParameters)$configBox.appParameters[t]=n.appParameters[t];this.initApp.forEach(function(t){n.initObject(t)}),this.initController[this.CurrentController]&&this.initController[n.CurrentController].forEach(function(t){n.initObject(t)}),this.initControllerAction[this.CurrentControllerAction]&&this.initControllerAction[n.CurrentControllerAction].forEach(function(t){n.initObject(t)})},initObject:function(t,o){o=void 0==o?{}:o,(n.checkInit(t)||o.noCheck)&&window[t].init()},checkInit:function(n){return void 0==this.storeInit[n]?(this.storeInit[n]=1,!0):!1},information:function(){console.log("Controller: "+n.CurrentController),console.log("Action: "+n.CurrentAction),console.log("CurrentControllerAction: "+n.CurrentControllerAction)},setInit:function(t,o){n.initObject(t,o)},startFunction:function(n){n=void 0==n?{}:n,n.nameObject&&n.nameFunction&&window[n.nameObject][n.nameFunction]()}};return{initStart:n.initStart,setInit:n.setInit,startFunction:n.startFunction,i:n.information}}();
function noty(t,e,n,s,a){e=e||5e3,n=n||"error",a=a||!0;var o=toastr;return o.options={closeButton:a,timeOut:e},o[n](t),o}function open_in_new_tab(t){var e=window.open(t,"_blank");e.focus()}function c(t){console.log(t)}function VD(t){console.log(t)}var $noty=[],$main={init:function(){$("a.btn, button.btn, span.tltp, input.tltp, span").tooltip(),$("body").on("contentLoad",function(){$("a.btn, button.btn, span.tltp, input.tltp, span").tooltip()}),$main.activeMenu(),$main.activeHover(),$("#exit").click(function(){return $("#exitModal").modal("show"),!1}),$('input[type="text"], input[type="tel"], select').on("keypress change",function(){$(this).closest(".error").removeClass("error").end().closest(".has-error").removeClass("has-error").end()}),$main.activeMask(),$.fn.google_virtual_keyboard=function(t){if(!this.length)return this;"undefined"==typeof t&&(t={});var e={};t=$.extend(!0,e,t),this.each(function(){$(this).addClass("js-virtual-keyboard"),$(this).after('<span class="js-virtual-keyboard-icon"></span>')});var n=null;$(document).on("click",".js-virtual-keyboard-icon",function(){if(!n){var t=document.createElement("script");t.src="https://www.google.com/uds/?file=elements&amp;v=1&amp;packages=keyboard";var e=document.createElement("script");e.src="https://www.google.com/uds/api/elements/1.0/7ded0ef8ee68924d96a6f6b19df266a8/keyboard.I.js";var s=document.createElement("script");s.src="https://www.google.com/uds/modules/elements/keyboard/uk_101.js",document.body.appendChild(t),t.onload=function(){document.body.appendChild(e)};var a=document.createElement("link");a.href="https://www.google.com/uds/api/elements/1.0/7ded0ef8ee68924d96a6f6b19df266a8/keyboard.css",a.rel="stylesheet",document.body.appendChild(a),e.onload=function(){document.body.appendChild(s)},s.onload=function(){n=new google.elements.keyboard.Keyboard([google.elements.keyboard.LayoutCode.UKRAINIAN_101])}}var o=setInterval(function(){$("#kbd-logo").length&&$("#kbd-logo").prop("src")!=window.gulpDeploy+"/img/gwe_transparent_130x20.png"&&($("#kbd-logo").prop("src",window.gulpDeploy+"/img/gwe_transparent_130x20.png").css("max-width","91px"),clearInterval(o))},10);if(n){n.setVisible(!n.isVisible());var i=$(this).prev(".js-virtual-keyboard");i.focus()}});var s=null;$(document).on("focus",".js-virtual-keyboard",function(){s=$(this)}),$(document).on("click",".goog-button",function(){s&&s.focus().trigger("keyup")})},$("li.dropdown").hover(function(){$(this).find(".dropdown-menu").stop(!0,!0).delay(100).fadeIn(0)},function(){$(this).find(".dropdown-menu").stop(!0,!0).delay(300).fadeOut(100)});var t;$("#top_menu > li.menu").bind({hover:function(){var e=$(this);$("#top_menu > li.menu").removeClass("show_sub"),clearInterval(t),t=setInterval(function(){e.addClass("show_sub")},500)},mouseleave:function(){clearInterval(t),$("#top_menu > li.menu").removeClass("show_sub")}}),$("li.dropdown").hover(function(){$(this).find(".dropdown-menu").stop(!0,!0).delay(100).fadeIn(0)},function(){$(this).find(".dropdown-menu").stop(!0,!0).delay(300).fadeOut(100)}),$("div.message").find("button.close").click(function(){var t=$(this).closest("div.message").data("message");$.cookie(t,0)});var e=$("#noty_success").text().trim();e.length>1&&(noty(Yii.t("orders/js",e),5e3,"success","center"),$("#notyMessage").text("")),e=$("#noty_error").text().trim(),e.length>1&&(noty(Yii.t("orders/js",e),5e3,"error","center"),$("#notyMessage").text("")),e=$("#noty_warning").text().trim(),e.length>1&&(noty(Yii.t("orders/js",e),5e3,"warning","center"),$("#notyMessage").text(""))},activeMenu:function(){$("select.custom-select").selectBoxIt({autoWidth:!1,hideCurrent:!0,showEffect:"slideDown",showEffectSpeed:200,hideEffect:"slideUp",hideEffectSpeed:100}),$(".selectboxit-container").on("load",function(){$("[rel='popover']").popover({trigger:"hover",container:"body"})})},showProgressRow:function(t,e){if(void 0!=e)var n=$(e).find("tr:first > th").length;else var n=$("tr:first > th").length;return $("<tr>").attr("id",t+"_progress").append($("<td>").attr("colspan",n).append($("<div>").addClass("progress").addClass("progress-striped").addClass("active").css("margin","5px 0").append($("<div>").addClass("bar").addClass("bar-danger").css("width","100%"))))},activeHover:function(){$(".popovr").popover({trigger:"hover",animation:!1,delay:{show:500,hide:100}})},activeMask:function(){$("input.mask-double_3_1").mask("099C0"),$("input.mask-double_4_1").mask("0999C0"),$("input.mask-double_4_3").mask("0999C099"),$("input.mask-double_4_4").mask("0999C0999"),$("input.mask-double_5_1").mask("09999C0"),$("input.mask-double_6_0").mask("099999"),$("input.mask-double_7_1").mask("0999999C0"),$("input.mask-double_7_2").mask("0999999C09"),$("input.mask-double_9_1").mask("099999999C0"),$("input.mask-double_9_2").mask("099999999C09"),$("input.mask-double_10_0").mask("0999999999"),$("input.mask-double_10_2").mask("0999999999C09"),$("input.mask-double_10_10").mask("0999999999C0999999999"),$("input.mask-integer_14").mask("##############"),$("input.mask-ref_or_number").mask("X",{translation:{X:{pattern:/[[A-Za-z0-9\-]/,recursive:!0}}}),$("input.mask-integer_6_nozero").mask("199999",{translation:{1:{pattern:/[1-9]/}},9:{pattern:/[0-9]/,optional:!0}}),$("input.mask-integer_9_nozero").mask("199999999",{translation:{1:{pattern:/[1-9]/}},9:{pattern:/[0-9]/,optional:!0}}),$("input.mask-integer_9").mask("099999999"),$("input.mask-integer_6").mask("099999"),$("input.mask-integer_5").mask("09999"),$("input.mask-integer_4").mask("0999"),$("input.mask-integer_3").mask("099"),$("input.mask-integer_2").mask("09"),$("input.mask-integer_1").mask("0"),$("input.mask-char_uk_s").mask("L"),$("input.mask-integer").mask("#"),$("input.mask-char_uk").mask("U"),$("input.mask-char").mask("E"),$("input.mask-latin_numbers").mask("N",{translation:{N:{pattern:/[a-zA-Z0-9]/,recursive:!0}}}),$("input.mask-char_no_latin").mask("N",{translation:{N:{pattern:/[а-яА-Я,ёЁіІїЇєЄґҐюЮ\d\s\.\№\'\’\`\,\\\(\)\-\u002F]/,recursive:!0}}}),$("input.mask-latin_numbers_space").mask("N",{translation:{N:{pattern:/[a-zA-Z0-9\s]/,recursive:!0}}}),$("input.mask-email").mask("E",{translation:{E:{pattern:/[a-zA-Z0-9\_\-\.\%\+\@]/,recursive:!0}}}),$("input.mask-phone").mask("0999999999",{translation:{0:{pattern:/[0]/},9:{pattern:/[\d]/}}}),$("input.mask-phone_12").mask("380999999999",{translation:{3:{pattern:/[380]/},7:{pattern:/[\d]/}}}),$("input.mask-date").mask("09.09.0000"),$("input.mask-datetime").mask("09.09.0000 09:09"),$("input.mask-uk_first_upper").mask("X",{translation:{X:{pattern:/[абвгґдеєжзиіїйклмнопрстуфхцчшщьюя,0-9\'\`\’\-\s\"]/i,recursive:!0}}}),$("input.mask-uk_first_upper_with_dot").mask("X",{translation:{X:{pattern:/[абвгґдеєжзиіїйклмнопрстуфхцчшщьюя,0-9\.\'\`\’\-\s\"]/i,recursive:!0}}}),$("input.mask-uk_first_upper_nospaces").mask("X",{translation:{X:{pattern:/[абвгґдеєжзиіїйклмнопрстуфхцчшщьюя\'\`\’\-]/i,recursive:!0}}}),$("input.mask-uk_fio").mask("X",{translation:{X:{pattern:/[а-яА-ЯёЁіІїЇєЄґҐюЮ\'\`\’\-]/,recursive:!0}}}),$("input.mask-uk_first_upper, input.mask-uk_first_upper_nospaces, input.mask-uk_first_upper_with_dot").keyup(function(){string=$(this).val()," "==string.charAt(0)&&(string=string.substr(1,string.length)),$(this).val(string.charAt(0).toUpperCase()+string.substr(1))})}},WPredefinedValues=function(){var t={},e=function(e){return t[e]};return e}();
!function(t){t.fn.datetimepicker.dates.ru={days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],daysShort:["Вск","Пнд","Втр","Срд","Чтв","Птн","Суб","Вск"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб","Вс"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Сегодня",clear:"Очистить",suffix:[],meridiem:[]}}(jQuery);
!function(t){t.fn.datetimepicker.dates.uk={days:["Неділя","Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота","Неділя"],daysShort:["Нед","Пнд","Втр","Срд","Чтв","Птн","Суб","Нед"],daysMin:["Нд","Пн","Вт","Ср","Чт","Пт","Сб","Нд"],months:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],monthsShort:["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],today:"Сьогодні",clear:"Очистити",suffix:[],meridiem:[]}}(jQuery);
if("undefined"==typeof Yii)var Yii={};Yii.translate={dictionary:{},config:{language:""}},Yii.translate.process=function(message,params,dictionary){var translation=dictionary&&"undefined"!=typeof dictionary[message]?dictionary[message]:message;"undefined"==typeof params&&(params=0);var num=0;params%1===0&&(params={n:params}),params.n%1===0&&(num=params.n);var chunks=translation.split("|");if(-1!==translation.indexOf("#"))for(var i=0;i<chunks.length;i++){var pieces=chunks[i].split("#"),ex=pieces[0],msg=pieces[1];if(2==pieces.length){ex%1===0&&(ex="n=="+ex);var eval_expr=ex.split("n").join(num);if(eval(eval_expr)){translation=msg;break}}}else chunks.length>1&&(translation=1==num?chunks[0]:chunks[1]);for(var key in params)translation=translation.split("{"+key+"}").join(params[key]);return translation},Yii.t=function(a,i,n,e){var t=e?e:Yii.translate.config.language,s=!1;return"undefined"!=typeof Yii.translate.dictionary[t]&&a&&"undefined"!=typeof Yii.translate.dictionary[t][a]&&(s=Yii.translate.dictionary[t][a]),Yii.translate.process(i,n,s)};
Object.size=function(t){var e,r=0;for(e in t)t.hasOwnProperty(e)&&r++;return r};var UrlManager=function(){var t="get",e="path",r=function(e){this.opts={rules:{},urlSuffix:"",showScriptName:!0,appendParams:!0,routeVar:"r",caseSensitive:!0,matchValue:!1,useStrictParsing:!0,urlFormat:t};for(var r in e)this.opts[r]=e[r];this._rules=[],this.processRules()};return r.prototype.processRules=function(){if(0!==Object.size(this.opts.rules)&&this.urlFormat!==t)for(var e in this.opts.rules){var r=this.opts.rules[e];this._rules.push(this.createUrlRule(r,e))}},r.prototype.addRules=function(t,e){if(e="undefined"!=typeof e?e:!0)for(var r in this.opts.rules){var s=this.opts.rules[r];this._rules.push(this.createUrlRule(s,r))}else{t.reverse();for(var r in this.opts.rules){var s=this.opts.rules[r];this._rules.unshift(this.createUrlRule(s,r))}}},r.prototype.createUrl=function(t,e,r){e=e||[],r=r||"&",e=JSON.parse(JSON.stringify(e)),delete e[this.opts.routeVar];for(var s in e){var i=e[s];null===i&&(e[s]="")}var a="";"#"in e&&(a="#"+e["#"],delete e["#"]),t=t.replace(/\/+$/,"");for(var s in this._rules){var n=this._rules[s],u=n.createUrl(this,t,e,r);if(u!==!1)return n.hasHostInfo?""===u?"/"+a:u+a:this.getBaseUrl()+"/"+u+a}return this.createUrlDefault(t,e,r)+a},r.prototype.createUrlDefault=function(t,r,s){if(this.opts.urlFormat===e){var i=this.getBaseUrl()+"/"+t+"/";if(i=i.replace(/\/+$/,""),this.opts.appendParams){var a=i+"/"+this.createPathInfo(r,"/","/");return i=a.replace(/\/+$/,""),""===t?i:i+this.opts.urlSuffix}""!==t&&(i+=this.opts.urlSuffix);var n=this.createPathInfo(r,"=",s);return""===n?i:i+"?"+n}var i=this.getBaseUrl(),n=this.createPathInfo(r,"=",s);return this.opts.showScriptName||(i+="/"),""!==t?(i+="?"+this.opts.routeVar+"="+t,""!==n&&(i+=s+n)):""!==n&&(i+="?"+n),i},r.prototype.createPathInfo=function(t,e,r,s){s=s||null;var i=[];for(var a in t){var n=t[a];null!==s&&(a=s+"["+a+"]"),"[object Array]"===Object.prototype.toString.call(n)?i.push(this.createPathInfo(n,e,r,a)):i.push(encodeURIComponent(a)+e+encodeURIComponent(n))}return i.join(r)},r.prototype.createUrlRule=function(t,e){return new UrlRule(t,e)},r.prototype.getBaseUrl=function(){return this.opts.showScriptName?Yii.app.scriptUrl:Yii.app.baseUrl},r}.call(this),UrlRule=function(){var t=function(t,e){if(this.references={},this.params={},this.caseSensitive=null,this.routePattern=null,this.defaultParams={},this.matchValue=null,this.urlSuffix=null,this.matchValue=null,this.verb=null,this.routePatternGroups=[],"object"==typeof t){var r=["urlSuffix","caseSensitive","defaultParams","matchValue","verb","parsingOnly"];for(var s in r){var i=r[s];i in t&&(this[i]=t[i])}"pattern"in t&&(e=t.pattern),t=t[0]}var a={};if(a["/"]="\\/",this.route=t.replace(/\/+$/,""),-1!==t.indexOf("<"))for(var n=/<(\w+)>/g,u=n.exec(t);null!==u;){var i=u[1];this.references[i]="<"+i+">",u=n.exec(t)}this.hasHostInfo="http://"===e.substring(0,7)||"https://"===e.substring(0,8);for(var o=/<(\w+):?(.*?)?>/g,l=o.exec(e);null!==l;){var i=l[1],h=l[2];(""===h||void 0===h)&&(h="[^/]+"),i in this.references?a["<"+i+">"]="(?P<"+i+">"+h+")":this.params[i]=h,l=o.exec(e)}var p=e.replace(/\*+$/,"");if(this.append=p!==e,p=p.replace(/^\/|\/$/g,""),this.template=p.replace(/<(\w+):?.*?>/g,"<$1>"),this.references!=={}){this.routePattern="^"+phpJS.strtr(this.route,a)+"$";for(var f=/\(\?P<(\w+)>.*?\)/g,c=f.exec(this.routePattern),v=0;null!=c;)this.routePatternGroups[c[1]]=v,v++,c=f.exec(this.routePattern);this.routePattern=this.routePattern.replace(/\(\?P<\w+>(.*?)\)/g,"($1)"),this.routePattern=this.routePattern.replace(/([^\\])([\+\*])/g,"$1$2?"),this.routePattern=this.routePattern.replace(/\(\((.*?)\)\)/g,"($1)")}};return t.prototype.createUrl=function(t,e,r,s){var i="";(t.opts.caseSensitive&&null===this.caseSensitive||this.caseSensitive)&&(i="i");var a={};if(e!==this.route){if(null===this.routePattern)return!1;var n=new RegExp(this.routePattern,i),u=e.match(n);if(null===u)return!1;for(var o in this.references){var l=this.references[o],h=this.routePatternGroups[o];a[l]=u[h+1]}}for(var o in this.defaultParams){var p=this.defaultParams[o];if(o in r){if(r[o]!=p)return!1;delete r[o]}}for(var o in this.params)if(!(o in r))return!1;if(t.opts.matchValue&&null===this.matchValue||this.matchValue)for(var o in this.params){var p=this.params[o],f=""+r[o];if(null===f.match(new RegExp("^"+p+"$",i)))return!1}for(var o in this.params)a["<"+o+">"]=encodeURIComponent(r[o]),delete r[o];var c=null===this.urlSuffix?t.opts.urlSuffix:this.urlSuffix,v=phpJS.strtr(this.template,a);if(this.hasHostInfo){var P=Yii.app.hostInfo.toLowerCase();0===v.toLowerCase().indexOf(P)&&(v=v.substring(P.length))}return 0===Object.size(r)?""!==v?v+c:v:(this.append?v+="/"+t.createPathInfo(r,"/","/")+c:(""!==v&&(v+=c),v+="?"+t.createPathInfo(r,"=",s)),v)},t}.call(this);
jQuery.fn.fastLiveFilter=function(e,i){i=i||{};var t,n=$(e),r=this,s=i.timeout||500,l=i.callback||function(){},o=(i.type||"",n.children(".browser_element_main").not(".removed")),a=o.length,c=a>0?o[0].style.display:"block";return l(a),r.unbind("keydown change"),r.change(function(){for(var e,t=r.val().toLowerCase(),s=0,d=0;a>d;d++)e=o[d],(e.textContent.trim()||e.innerText.trim()||"").toLowerCase().search(new RegExp(t,"i"))>=0?("none"==e.style.display&&(e.style.display=c),s++):"none"!=e.style.display&&(e.style.display="none");return l(s),"cities"==i.type&&0==s&&n.find("#messageNoneOfACities").show(),0==s?n.find("p.empty_list").show():s>0&&n.find("#messageNoneOfACities, p.empty_list").hide(),!1}).keydown(function(e){var i=e.keyCode?e.keyCode:e.which,l=!1;switch(i){case 40:var o=n.find("li.browser_element_main.active");0===o.length?n.find("li.browser_element_main").first(":visible").trigger("click"):o.next(":visible").trigger("click"),l=!0;break;case 38:n.find("li.browser_element_main.active").prev(":visible").trigger("click"),l=!0}l||(clearTimeout(t),t=setTimeout(function(){r.change(),n.find("li.browser_element_main:visible").first().trigger("click")},s))}),this};